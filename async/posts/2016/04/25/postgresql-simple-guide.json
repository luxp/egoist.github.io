{"tags":[{"name":"postgresql","permalink":"https://egoist.moe/tags/postgresql/","url":"/async/tags/postgresql.json","count":1},{"name":"database","permalink":"https://egoist.moe/tags/database/","url":"/async/tags/database.json","count":1}],"categories":[],"url":"/async/posts/2016/04/25/postgresql-simple-guide.json","date":1461575165000,"path":{"year":2016,"month":4,"day":25,"name":"postgresql-simple-guide"},"title":"PostgreSQL 简明指南","permalink":"https://egoist.moe/2016/04/25/postgresql-simple-guide/","content":"<p>边学边记录，有错请指出。（Keep Updating…）</p>\n<h2 id=\"span-基础-span\"><span>基础</span></h2>\n<h3 id=\"安装\">安装</h3>\n<p><code>postgresql-contrib</code> 不是必需的，它提供一些额外的功能。</p>\n<pre><code class=\"language-bash\">$ sudo apt-get update\n$ sudo apt-get install postgresql postgresql-contrib\n</code></pre>\n<p>安装完成后，它会自动在你的系统上新建一个叫 <code>postgres</code> 的用户，之后你需要切换过去来使用 <code>PostgreSQL</code>:</p>\n<pre><code class=\"language-bash\">$ sudo -i -u postgres\n</code></pre>\n<p>进入交互模式:</p>\n<pre><code class=\"language-bash\">$ psql\n# 想退出则输入 `\\q`\n</code></pre>\n<h3 id=\"初始化\">初始化</h3>\n<p>用默认账户登录到默认数据库:</p>\n<pre><code class=\"language-bash\">$ sudo -u postgres psql template1\n</code></pre>\n<p>修改默认账户的密码:</p>\n<pre><code class=\"language-sql\">$ postgres=# ALTER USER postgres with encrypted password 'xxxxxxx';\n</code></pre>\n<p>然后修改 <code>pg_hba.conf</code> 让其用 <code>md5</code> 方式加密:</p>\n<pre><code class=\"language-bash\"># 9.1 是版本号\n$ sudo vim /etc/postgresql/9.1/main/pg_hba.conf\n</code></pre>\n<p>这样修改: local      all     postgres     <s>peer</s> md5</p>\n<p>重启数据库:</p>\n<pre><code class=\"language-bash\">$ sudo /etc/init.d/postgresql restart\n</code></pre>\n<h3 id=\"新建用户和数据库\">新建用户和数据库</h3>\n<p>在默认的 Linux 账户 <code>postgres</code> 下，你可以创建创建一个新的用户:</p>\n<pre><code class=\"language-sql\">$ postgres=# CREATE USER egoist WITH PASSWORD 'your_password';\n</code></pre>\n<p>下一步是创建一个数据库，并让指定用户据有读写权限:</p>\n<pre><code class=\"language-sql\">$ postgres=# CREATE DATABASE database_a;\n</code></pre>\n<p>之后给予数据库 <code>database_a</code> 的权限到用户 <code>egoist</code>:</p>\n<pre><code class=\"language-sql\">$ postgres=# GRANT ALL PRIVILEGES ON DATABASE database_a to egoist;\n</code></pre>\n<h3 id=\"数据库相关查询\">数据库相关查询</h3>\n<h4 id=\"列出所有数据库\">列出所有数据库</h4>\n<pre><code class=\"language-bash\"># 当前用户\n# \\l 或者 \\list\n$ user=# \\list\n\n# 非 psql 交互模式下\n$ psql -U username -l\n</code></pre>\n<h2 id=\"span-推荐阅读-span\"><span>推荐阅读</span></h2>\n<ul>\n<li><a href=\"http://postgresguide.com\" target=\"_blank\" rel=\"external\">PostgreSQL Guide</a></li>\n</ul>\n"}