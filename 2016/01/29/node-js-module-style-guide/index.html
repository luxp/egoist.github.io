<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"><title>Node.js æ¨¡å—é£æ ¼æŒ‡å—</title><link rel="alternate" type="application/rss+xml" title="åº¶æ°‘æ ·æœ¬" href="/atom.xml"><link rel="stylesheet" href="https://fonts.css.network/css?family=Droid+Sans"><link href="/css/main.css?v=4.1.0" rel="stylesheet"><link rel="stylesheet" href="/css/highlight.css?v=4.1.0"><link rel="stylesheet" href="/css/zoom.css"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@rem_rin_rin"><meta name="twitter:title" content="Node.js æ¨¡å—é£æ ¼æŒ‡å—"><meta name="description" content="ç¼–å†™é«˜è´¨é‡ã€å¯å¤ç”¨çš„ Node.js æ¨¡å—"><meta name="twitter:description" content="ç¼–å†™é«˜è´¨é‡ã€å¯å¤ç”¨çš„ Node.js æ¨¡å—"></head><body><header class="header"><h1 class="site-name"><a href="/">e.z.</a></h1><ul class="nav"><li><a href="/about.html">about</a></li><li><a href="/girls.html">girls</a></li><li><a href="/donate.html">donate</a></li><li class="hide-on-small-screen"><a href="/gf.html">girlfriend wanted</a></li></ul></header><section class="centered post-page"><article class="post"><h2 class="post-title">Node.js æ¨¡å—é£æ ¼æŒ‡å—</h2><h2 class="post-subtitle">ç¼–å†™é«˜è´¨é‡ã€å¯å¤ç”¨çš„ Node.js æ¨¡å—</h2><script></script><div class="post-content markdown-body"><p>JavaScript ä»£ç ä¸€å‘çš„ç‰¹ç‚¹å°±æ˜¯éš¾ä»¥ç»´æŠ¤ï¼Œä¿æŒä¸€ä¸ªè‰¯å¥½çš„ä»£ç ã€ç»„ç»‡é£æ ¼æœ‰åŠ©äºæå‡æ•ˆç‡ã€é‡æ„ä»£ç ã€æ·»åŠ æ–°åŠŸèƒ½ã€å•å…ƒæµ‹è¯•ç­‰ç­‰ã€‚</p>
<p>æˆ‘æ€»ç»“äº†ä¸€ä¸‹å†™äº† 200 ä¸ª NPM package ä¹‹åçš„ä¸€äº›ä¸ªäººç»éªŒå’Œä¹ æƒ¯ã€‚</p>
<h2 id="span-åˆå§‹åŒ–ä¸€ä¸ªé¡¹ç›®-span"><span>åˆå§‹åŒ–ä¸€ä¸ªé¡¹ç›®</span></h2>
<p>ä¸å†ä½¿ç”¨ <code>npm init</code>ã€‚å› ä¸ºé™¤äº† <code>package.json</code> è¿˜æœ‰ä¸€äº›é¢å¤–çš„é…ç½®æ–‡ä»¶ï¼Œæ¯”å¦‚ <code>circle.yml</code>ã€<code>.editorconfig</code>ã€<code>LICENSE</code> ã€<code>README.md</code> ç­‰ç­‰ã€‚</p>
<p>ä½¿ç”¨ <a href="http://yeoman.io" target="_blank" rel="external">yeoman</a>ã€‚å¦‚æœä½ å–œæ¬¢åœ¨ä»£ç ä¸­ä½¿ç”¨åˆ†å·å’Œç”¨ travis æ¥æµ‹è¯•ï¼Œæ¨è <a href="https://github.com/sindresorhus" target="_blank" rel="external">sindresorhus</a> ç”¨çš„ <a href="https://github.com/sindresorhus/generator-nm" target="_blank" rel="external">generator-nm</a>ã€‚å¦‚æœä½ ä¸å–œæ¬¢åˆ†å·å¹¶ä¸”ç”¨ circle æ¥æµ‹è¯•ï¼Œæ¨èæˆ‘ç”¨çš„ <a href="https://github.com/egoist/generator-esnm" target="_blank" rel="external">generator-esnm</a>ã€‚</p>
<p>æƒ³è¦å®šåˆ¶ä½ çš„ <a href="http://README.md" target="_blank" rel="external">README.md</a> ? <a href="https://github.com/IonicaBizau/blah" target="_blank" rel="external">blah</a> å¯ä»¥ä¸ºä½ å®šåˆ¶ç”Ÿæˆ <a href="http://README.md" target="_blank" rel="external">README.md</a> ä»¥åŠæ›´å¤šæå‡æ•ˆç‡çš„åŠŸèƒ½ã€‚</p>
<h2 id="span-æ³¨é‡Š-span"><span>æ³¨é‡Š</span></h2>
<p>æ¯ä¸€ä¸ªå…·æœ‰å•ç‹¬æ„ä¹‰çš„ä»£ç ç‰‡æ®µå‰éƒ½æ¨èå†™æ³¨é‡Šï¼Œå°±ç®—å†ç®€å•çš„ä»£ç ä½ éš”å‡ å¤©çœ‹ä¹Ÿä¸å¯èƒ½ä¸€ç§’çœ‹å‡ºå®ƒåœ¨å¹²ä»€ä¹ˆï¼Œè€Œæœ‰äº†æ³¨é‡Šå°±å¯ä»¥ã€‚å¯¹äºå¤æ‚ä¸”æ„ä¹‰é‡å¤§çš„ä»£ç å°½é‡å†™å®Œæ•´çš„ jsdoc æ¥è¯´æ˜ã€‚</p>
<p>å¦ä¸€ä¸ªåŸå› å°±æ˜¯è¿™æ ·å¯ä»¥è®©ä½ çš„ä»£ç æ˜¾å¾—æ›´æ ¼å¼åŒ–ï¼Œä»£ç æŒ¤åœ¨ä¸€å †å¾ˆå‚»ä¸”ä¸ç¾è§‚ã€‚è€Œä¸”ä½ ä¹Ÿå¯ä»¥è‡ªåŠ¨ä»ä½ ä»£ç çš„ jsdoc ç”Ÿæˆ api docï¼</p>
<pre><code class="language-js">/**	
 * Module dependencies
 */
const path = require('path')

/**
 * Reverse array but not change itself
 *
 * @param {Array} names
 * @return {Array}
 */
function rev(names) {
	return names.concat().reverse()
}
</code></pre>
<h2 id="span-ç¼–å†™å¯å¤ç”¨æ¨¡å—-span"><span>ç¼–å†™å¯å¤ç”¨æ¨¡å—</span></h2>
<p>å¯¹äºä¸€ä¸ªé¡¹ç›®ä¸­å¤šæ¬¡ä½¿ç”¨ï¼ˆ&gt;1ï¼‰çš„ä»£ç ï¼Œæ¨èæ”¾å…¥å•ç‹¬çš„æ–‡ä»¶ä½œä¸ºæ¨¡å—ä½¿ç”¨ã€‚<br>
å¯¹äºæ›´ä¸ºé€šç”¨çš„ä»£ç å°½é‡æ‰“åŒ…è¿›ä¸€ä¸ªå•ç‹¬çš„ npm module æ¥ä½¿ç”¨ã€‚</p>
<h2 id="span-ä»£ç é£æ ¼æŒ‡å—-span"><span>ä»£ç é£æ ¼æŒ‡å—</span></h2>
<p>å¯¹äºåˆ†å·çš„é—®é¢˜ä¸ä½œè®¨è®ºï¼ŒåŠ ä¸åŠ éƒ½è¡Œã€‚</p>
<p>å¯¹äºå¼‚æ­¥ä»£ç ï¼Œå°½é‡ä¸è¦ä½¿ç”¨ callback è€Œæ˜¯æ”¹æˆ Promiseï¼Œå¹¶ä¸”æŠŠ HTTP è¯·æ±‚å°è£…è¿›å•ç‹¬çš„æ¨¡å—ï¼Œè¿™æ ·æ›´æ–¹ä¾¿é…åˆ <a href="https://github.com/tj/co" target="_blank" rel="external">co</a> æ¥ä½¿ç”¨ã€‚</p>
<pre><code class="language-js">// fetchData.js
// è€å¼å›è°ƒé£æ ¼
const request = require('superagent')

module.exports = function (callback) {
	request
		.get('xxx.json')
		.end((err, res) =&gt; {
			callback(res)
		})
}
// app.js
// è°ƒç”¨å®ƒ
const fetchData = require('./fetchData')

module.exports = function () {
	fetchData(data =&gt; {
		console.log(data)
	})
}

// fetchData.js
// æ— é˜»å¡åŒæ­¥ä»£ç é£æ ¼
const fetch = require('node-fetch')

module.exports = co.wrap(function* () {
	const data = yield fetch('xxx.json')
		.then(data =&gt; data.json())
	return data
})
// app.js
// è°ƒç”¨å®ƒ
const fetchData = require('./fetchData')

module.exports = co.wrap(function* () {
	const data = yield fetchData()
	console.log(data)
})
</code></pre>
<p><strong>è¿˜ä½¿ç”¨ co? ä¸æ˜¯æœ‰ async/await å—?</strong></p>
<p>åœ¨ async/await æ²¡è¢« v8 å¼•æ“å®ç°ä¹‹å‰ç”¨ co éƒ½è¿˜æ˜¯ç¬¬ä¸€é€‰æ‹©ï¼Œé™¤éæŸäº›æƒ…å†µä½ ä½¿ç”¨äº† babel é‚£ä½ å¯ä»¥è€ƒè™‘ä½¿ç”¨ async/awaitã€‚ä¸è¿‡å³ä½¿ç°åœ¨ç”¨ co åœ¨å°†æ¥ async/await api è¢«å®ç°çš„æ—¶å€™ä¹Ÿèƒ½è½»æ¾åœ°è¿ç§»è¿‡å»ã€‚</p>
<blockquote>
<p>co is a stepping stone towards ES7 async/await â€“ TJ Holowaychuk</p>
</blockquote>
<h2 id="span-eslint-span"><span>ESLint</span></h2>
<p>ä¿æŒè‰¯å¥½ä»£ç é£æ ¼çš„æ–¹æ³•ä¹‹ä¸€å°±æ˜¯ lint ä½ çš„ä»£ç ï¼Œé€‰æ‹©ä½ ä¹ æƒ¯çš„ä»£ç é£æ ¼ï¼Œç”¨ç¼–è¾‘å™¨å®æ—¶ lint æˆ–è€…æ·»åŠ ä¸€äº› git hook åœ¨ commit çš„æ—¶å€™ lint ä¹Ÿå¯ä»¥ã€‚</p>
<p>æˆ‘ç›®å‰ä½¿ç”¨ <a href="https://github.com/sindresorhus/xo" target="_blank" rel="external">xo</a> æ¥æ£€æµ‹ä»£ç ï¼Œå®ƒé»˜è®¤æ— éœ€é…ç½®ä½†ä½ å¯ä»¥æ ¹æ®ä½ çš„å–œå¥½è°ƒæ•´ï¼ŒåŸºäº ESLint ã€‚å¦‚æœä½ å–œæ¬¢è¿™ä¸ªé£æ ¼ä¹Ÿå¯ä»¥ç›´æ¥åœ¨ ESlint ä¸­ä½¿ç”¨å®ƒçš„<a href="https://github.com/sindresorhus/eslint-config-xo" target="_blank" rel="external">é…ç½®æ–‡ä»¶</a>ã€‚</p>
<h2 id="span-æµ‹è¯•-span"><span>æµ‹è¯•</span></h2>
<p>å†™æµ‹è¯•æ˜¯å¾ˆæœ‰è¶£çš„ï¼Œå½“ä¸”ä»…å½“ä½ ç”¨ <a href="https://github.com/sindresorhus/ava" target="_blank" rel="external">AVA</a> çš„æ—¶å€™ã€‚</p>
<p><img src="https://camo.githubusercontent.com/fc55513ee5cb412b2b0d1540032b602ed0142dbe/68747470733a2f2f63646e2e7261776769742e636f6d2f73696e647265736f726875732f6176612f666531636561316361336432633835313863306363333965633862653539326265616239303535382f6d656469612f6c6f676f2e737667" alt="ava"></p>
<p>æˆ‘ä½¿ç”¨ AVA çš„ä¸»è¦åŸå› æ˜¯:</p>
<ul>
<li>å¾ˆå¿«</li>
<li>è¯­æ³•ç®€æ´</li>
<li>å†…ç½® ES2015/2016</li>
<li>many moreâ€¦</li>
</ul>
<h2 id="span-commit-span-é£æ ¼"><span>Commit</span> é£æ ¼</h2>
<p>ä¸ä½¿ç”¨æ²¡æœ‰æ„ä¹‰çš„ Commit ä¿¡æ¯ï¼Œæ¯”å¦‚å•çº¯åªå†™ä¸ª <code>fix</code>ã€<code>update</code>ã€<code>change</code>ã€‚</p>
<p>å°½é‡æè¿°ä½ å¹²äº†ä»€ä¹ˆäº‹:</p>
<pre><code class="language-bash">git commit -m &quot;fix tweak on ie9&quot;
git commit -m &quot;release 0.0.1&quot;
git commit -m &quot;refactor to use es2015&quot;
git commit -m &quot;ğŸ”¥&quot;
</code></pre>
<p>æ›´å¥½çš„åšæ³•æ˜¯ä½¿ç”¨ <a href="https://github.com/commitizen/cz-cli" target="_blank" rel="external">commitizen</a> æ¥è§„èŒƒä½ çš„ commit message æ ¼å¼ã€‚</p>
<p><img src="https://github.com/commitizen/cz-cli/raw/master/meta/screenshots/add-commit.png" alt="commitizen"></p>
<h2 id="span-semantic-release-span"><span>Semantic-Release</span></h2>
<p>å‘å¸ƒ NPM æ¨¡å—æ˜¯å¾ˆè®©äººå›°æ‰°çš„ä¸€æ­¥ï¼Œä½ éœ€è¦æ‰‹åŠ¨ bump versionï¼Œéœ€è¦æ‰§è¡Œ <code>npm test</code> æ¥çœ‹æ˜¯å¦æœ‰é”™ï¼Œç„¶åå†æ‰‹åŠ¨æ‰§è¡Œ <code>npm publish</code>ï¼Œè¿™äº›æ­¥éª¤å¯ä»¥è¢«è§„èŒƒä¸”è‡ªåŠ¨åŒ–ã€‚</p>
<p>ä½¿ç”¨ <a href="https://github.com/semantic-release/semantic-release" target="_blank" rel="external">semantic-release</a> å¯ä»¥è‡ªåŠ¨åˆ†æä½ çš„ commit message ç„¶åæ ¹æ®è¿™äº›æ¨æµ‹ä½ çš„ä»£ç æ”¹åŠ¨æ¥è¿›è¡Œè¯­ä¹‰åŒ–çš„ç‰ˆæœ¬å·å‡çº§å¹¶è‡ªåŠ¨æ›´æ–° changelogï¼Œ<a href="https://github.com/egoist/tooling/releases" target="_blank" rel="external">è¿™äº›</a> å°±æ˜¯è‡ªåŠ¨ç”Ÿæˆçš„ã€‚</p>
<h2 id="span-2016-span"><span>2016</span></h2>
<p>200 more modules? Exciting! âœ¨</p>
</div><div id="disqus_thread" class="disqus"></div><script>window.isPost = true;
var disqus_config = function () {
  this.page.url = 'https://egoistian.com/2016/01/29/node-js-module-style-guide/'; // Replace PAGE_URL with your page's canonical URL variable
  this.page.identifier = '2016/01/29/node-js-module-style-guide/'; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};</script><noscript>Please enable JavaScript to view the<a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript><div class="post-report-bug">æ–‡ç« å‹˜è¯¯å¯ä»¥ç›´æ¥åˆ° <a target="_blank" href="https://github.com/egoist/blog/blob/master/source/_posts/node-js-module-style-guide.md">æºä»£ç åœ°å€</a> ä¿®æ”¹æˆ–è€… <a target="_blank" href="https://github.com/egoist/blog/issues/new">æäº¤ ISSUE</a>ï¼Œæ„Ÿè°¢é˜…è¯»ï¼</div></article></section><footer class="footer"><div class="centered"><a href="https://creativecommons.org/licenses/by-nc-nd/4.0/deed.zh" class="hide-on-mobile">CC BY-NC-ND 4.0</a><span class="hide-on-mobile">&nbsp;</span><span>&copy;&nbsp;</span><a href="https://github.com/egoist">E.Z.</a><span class="hide-on-mobile">&nbsp;</span><a href="https://github.com/egoist/blog" class="hide-on-mobile">Read the source code.</a></div></footer><div style="display:none"></div><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-54857209-6', 'auto');
ga('send', 'pageview');</script><script src="/js/highlight.min.js?v=4.1.0"></script><script src="/js/zoom.js"></script><script>window.hexoLayout = "post"</script><script src="/js/app.js?v=4.1.0"></script></body></html>