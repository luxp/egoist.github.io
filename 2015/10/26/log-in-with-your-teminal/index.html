<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"><title>在终端里使用第三方登录</title><link rel="alternate" type="application/rss+xml" title="庶民样本" href="/atom.xml"><link href="/css/main.css?v=4.4.0" rel="stylesheet"><link rel="stylesheet" href="/css/highlight.css?v=4.4.0"><link rel="stylesheet" href="/css/zoom.css?v=4.4.0"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@rem_rin_rin"><meta name="twitter:title" content="在终端里使用第三方登录"><meta name="description" content="显然你经常在网页和 APP 里使用第三方登录功能，比如用微博登录、用 QQ 登录、用 GitHub 登录，具体的方式是打开相关网页进行授权或者移动端可以利用应用内授权机制授权，那么在终端里如何操作第三"><meta name="twitter:description" content="显然你经常在网页和 APP 里使用第三方登录功能，比如用微博登录、用 QQ 登录、用 GitHub 登录，具体的方式是打开相关网页进行授权或者移动端可以利用应用内授权机制授权，那么在终端里如何操作第三"></head><body><header class="header"><h1 class="site-name"><a href="/">e.z.</a></h1><ul class="nav"><li><a href="/about.html">about</a></li><li><a href="/girls.html">girls</a></li><li><a href="/donate.html">donate</a></li></ul></header><section class="centered post-page"><article class="post"><h2 class="post-title">在终端里使用第三方登录</h2><script></script><div class="post-content markdown-body"><p>显然你经常在网页和 APP 里使用第三方登录功能，比如用微博登录、用 QQ 登录、用 GitHub 登录，具体的方式是打开相关网页进行授权或者移动端可以利用应用内授权机制授权，那么在终端里如何操作第三方账号登录呢？</p>
<p>很显然，也只能通过打开授权网页的方式获取需要的 access token 来进行操作。</p>
<h2 id="span-新建一个应用-span"><span>新建一个应用</span></h2>
<p>常规步骤，稍后会用在这里获得的 <code>Client ID</code> 和 <code>Client Secret</code> 进行授权验证。</p>
<h2 id="span-思路-span"><span>思路</span></h2>
<p>这些操作需要你将 API 搭建在自己的服务器上并且拥有数据库读写功能。</p>
<p>你需要用户触发登录操作之后以 GET 的方式打开一个授权网页，比如 <code>/api/login</code>，请求时在 URL Query String 中传输一个随机生成的用户 Unique ID，形如 <code>/api/login?uid=$UID</code>，推荐使用 <a href="https://www.npmjs.org/package/open" target="_blank" rel="external">open</a> 这个库打开网址。</p>
<p>授权成功之后获得的 access token 和 UID 保存到数据库，在之前打开授权页面的同时 POST 请求 <code>/api/token</code>，在 body 中传输 UID 信息，设置一个较高的 timeout 让网页不会返回超时。</p>
<p>在授权过程中由于并未获取到 token 所以让 <code>/api/token</code> 返回一个 50X 错误，判断获取到 50X 错误后用 setInterval 持续请求这个地址直到返回 200 代码，这个时候 access token 已经被你写入数据库并在这个页面上以 json 的格式输出了，于是这样你得到了需要的 access token，命令行现在可以打印出登录成功的提示信息了。</p>
</div><div id="disqus_thread" class="disqus"></div><script>window.isPost = true;
var disqus_config = function () {
  this.page.url = 'https://egoist.moe/2015/10/26/log-in-with-your-teminal/'; // Replace PAGE_URL with your page's canonical URL variable
  this.page.identifier = '2015/10/26/log-in-with-your-teminal/'; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};</script><noscript>Please enable JavaScript to view the<a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript><div class="post-report-bug">文章勘误可以直接到 <a target="_blank" href="https://github.com/egoist/blog/blob/master/source/_posts/log-in-with-your-teminal.md">源代码地址</a> 修改或者 <a target="_blank" href="https://github.com/egoist/blog/issues/new">提交 ISSUE</a>，感谢阅读！</div></article></section><footer class="footer"><div class="centered"><span class="hide-on-mobile"><a href="https://creativecommons.org/licenses/by-nc-nd/4.0/deed.zh">CC BY-NC-ND 4.0</a></span><span>&copy;</span><span><a href="https://github.com/egoist">E.Z.</a></span><span class="hide-on-mobile coding-support">Hosted by <a href="https://pages.coding.me" style="font-weight: bold">Coding Pages.</a></span><span class="hide-on-mobile"><a href="https://github.com/egoist/blog">Read the source code.</a></span></div></footer><div style="display:none"></div><script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-54857209-6', 'auto');
ga('send', 'pageview');</script><script async src="https://www.google-analytics.com/analytics.js"></script><script src="/js/highlight.min.js?v=4.4.0"></script><script src="/js/zoom.js?v=4.4.0"></script><script>window.hexoLayout = "post"</script><script src="/js/app.js?v=4.4.0"></script></body></html>